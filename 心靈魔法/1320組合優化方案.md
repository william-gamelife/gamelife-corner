# 1320英靈組合優化方案

## 一、當前問題分析

### 1.1 數據量問題
- 1320個組合 × 每個需要5-6個描述 = 約8000條內容
- 如果每個描述50字，總共約40萬字
- 太龐大，難以維護和生成

### 1.2 差異化問題
```
範例：相近組合的差異
#0237: ATH-PRO-HEP (理性-創新-實踐)
#0238: ATH-PRO-FRE (理性-創新-療癒)

這兩個只差在第三個神，描述要如何明顯區分？
```

## 二、優化方案

### 方案A：動態組合生成（推薦）

不預先寫好1320個描述，而是用**組合邏輯**即時生成：

```javascript
function generatePersonality(primary, secondary, hidden) {
  const base = getBasePersonality(primary);
  const modifier = getModifier(secondary);
  const undertone = getUndertone(hidden);
  
  return combineDescriptions(base, modifier, undertone);
}
```

#### 優點：
- 只需要寫12個主神的基礎特質
- 加上互動規則（12×12=144種互動）
- 系統自動組合出1320種變化

#### 實作方式：

```javascript
// 基礎人格模板
const BASE_TRAITS = {
  'ATH': {
    core: "你是理性分析的大師",
    strength: "邏輯思維清晰",
    weakness: "有時過於理性"
  },
  'APH': {
    core: "你用感性理解世界",
    strength: "直覺敏銳準確",
    weakness: "容易情緒化"
  }
  // ... 其他10個
};

// 互動修飾詞
const INTERACTIONS = {
  'ATH+APH': "理性與感性的平衡者",
  'ATH+HER': "思考後果斷行動",
  'ATH+PRO': "邏輯驅動的創新者",
  // ... 144種組合
};

// 隱藏特質影響
const HIDDEN_EFFECTS = {
  'HEP': "但總能落實執行",
  'FRE': "並帶著療癒能量",
  'AMA': "且勇於突破極限",
  // ... 12種
};
```

### 方案B：分類簡化（備選）

將1320個組合簡化成較少的類型：

#### 簡化邏輯：
1. **主神決定大類**（12類）
2. **次神決定子類**（12×11=132類）
3. **隱神只影響細節**（不另外分類）

這樣實際只需要寫132種主要描述。

### 方案C：AI輔助生成（快速方案）

使用模板+AI批量生成：

```python
template = """
編號：{number}
組合：{primary}-{secondary}-{hidden}

個性本質：
你是{primary_trait}的{primary_role}，
{secondary_trait}為你帶來{secondary_effect}，
而{hidden_trait}則在暗中{hidden_influence}。

主神優勢：{primary_advantage}
次神優勢：{secondary_advantage}  
隱神優勢：{hidden_advantage}

成長建議：
1. 平衡{weakness_area}
2. 發展{growth_area}
3. 注意{blind_spot}
"""
```

## 三、建議的混合方案

### 3.1 三層結構

```
第一層：主神類型（12種）
- 決定基本人格框架
- 提供核心描述

第二層：次神調整（144種）  
- 修改主神的表現方式
- 加入次要特質

第三層：隱神細節（1320種）
- 微調最終描述
- 加入潛在特質
```

### 3.2 實作範例

```javascript
class SpiritGenerator {
  
  // 生成個性描述
  generatePersonality(combo) {
    const [primary, secondary, hidden] = combo;
    
    // 基礎框架
    let description = this.coreTemplates[primary];
    
    // 次神調整
    description = this.applySecondaryModifier(
      description, 
      primary, 
      secondary
    );
    
    // 隱神影響
    description = this.addHiddenInfluence(
      description,
      hidden
    );
    
    return description;
  }
  
  // 生成優勢說明
  generateAdvantages(combo) {
    return {
      primary: this.primaryAdvantages[combo[0]],
      secondary: this.getContextualAdvantage(combo[1], combo[0]),
      hidden: this.hiddenAdvantages[combo[2]]
    };
  }
  
  // 生成成長建議
  generateSuggestions(combo, scores) {
    // 找出最低的3個神
    const weakest = this.findWeakestGods(scores);
    
    // 根據缺乏的特質給建議
    return weakest.map(god => 
      this.growthSuggestions[god]
    );
  }
}
```

## 四、資料庫結構優化

### 4.1 不要存1320筆完整資料

```javascript
// ❌ 不好的方式
const combinations = {
  "001": {
    personality: "完整的描述...",
    advantages: "...",
    suggestions: "..."
  },
  // ... 1319個
};

// ✅ 好的方式
const components = {
  cores: {}, // 12個
  interactions: {}, // 144個
  modifiers: {}, // 12個
  templates: {} // 幾個模板
};
```

### 4.2 使用編碼系統

```javascript
// 組合編碼
function encodeCombo(p, s, h) {
  // ATH-APH-HER => "001"
  return String(
    godsIndex[p] * 110 + 
    secondaryIndex[s] * 10 + 
    hiddenIndex[h]
  ).padStart(4, '0');
}

// 反向解碼
function decodeCombo(code) {
  // "001" => ["ATH", "APH", "HER"]
  const num = parseInt(code);
  const p = Math.floor(num / 110);
  const s = Math.floor((num % 110) / 10);
  const h = num % 10;
  
  return [gods[p], remaining[s], final[h]];
}
```

## 五、實作優先順序

### Phase 1：核心系統（立即）
1. 12個主神基礎描述 ✓
2. 測驗系統 ✓
3. 基本計分 ✓
4. 簡單結果顯示

### Phase 2：描述生成器（本週）
1. 建立組合規則
2. 寫144個互動描述
3. 測試生成效果

### Phase 3：內容豐富化（下週）
1. 優化描述模板
2. 加入更多變化
3. 個人化調整

## 六、給Claude Code的優化指令

```
請幫我設計一個「英靈描述生成器」：

需求：
1. 不要預存1320個描述
2. 用組合邏輯即時生成
3. 確保每個組合都獨特

輸入：三個神的代碼 (如 ATH, PRO, HEP)
輸出：
- 個性本質（3-4句）
- 三個優勢（各1-2句）
- 成長建議（3條）

請設計生成邏輯和資料結構。
```

## 七、範例對照表（驗證用）

為了確保生成品質，手寫幾個範例作為標準：

### #0001 ATH-APH-HER
**個性本質**：
你是理性與感性並存的矛盾體，擅長在邏輯分析後傾聽內心聲音。
行動力確保你不會陷入過度思考，能果斷將想法化為現實。

### #0002 ATH-APH-ODI  
**個性本質**：
你在理性與感性間找到平衡，並以深度思考處理兩者衝突。
你不急於下結論，而是給自己時間消化理性分析與感性直覺。

### #0003 ATH-APH-PRO
**個性本質**：
你的理性為創新提供框架，感性為創意注入靈魂。
這種組合讓你的創新既有邏輯支撐，又充滿情感共鳴。

用這些範例來校準生成器的輸出品質。